<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Live Stock Ticker (Socket.io)</title>
    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
    <style>
        body { font-family: 'Segoe UI', sans-serif; background: #0f172a; color: white; display: flex; justify-content: center; align-items: center; min-height: 100vh; }
        .card { background: #1e293b; padding: 40px; border-radius: 20px; text-align: center; width: 400px; box-shadow: 0 10px 30px rgba(0,0,0,0.5); }
        h2 { color: #38bdf8; margin-bottom: 5px; }
        .sub-text { color: #94a3b8; font-size: 0.9rem; margin-bottom: 30px; }
        
        .price-box { font-size: 3.5rem; font-weight: bold; margin: 20px 0; transition: color 0.3s; }
        .price-up { color: #4ade80; animation: flashGreen 0.5s; } 
        .price-down { color: #f87171; animation: flashRed 0.5s; } 
        
        .status { margin-top: 20px; font-size: 0.8rem; padding: 5px 10px; border-radius: 10px; display: inline-block; }
        .live { background: #064e3b; color: #34d399; }

        @keyframes flashGreen { 0% { background-color: rgba(74, 222, 128, 0.2); } 100% { background-color: transparent; } }
        @keyframes flashRed { 0% { background-color: rgba(248, 113, 113, 0.2); } 100% { background-color: transparent; } }
    </style>
</head>
<body>

    <div id="app" class="card">
        <h2>üìà Live Stock Ticker</h2>
        <p class="sub-text"> Real-Time Data Streaming</p>

        <div class="price-box" :class="priceColor">
            ${{ currentPrice }}
        </div>

        <p>Asset: {{ assetName }}</p>
        <p>Last Update: {{ lastUpdate }}</p>

        <div class="status live">
            {{ connected ? '‚óè LIVE FEED ACTIVE' : '‚óã DISCONNECTED' }}
        </div>
    </div>

    <script src="/socket.io/socket.io.js"></script>
    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>

    <script>
        const { createApp } = Vue;

        createApp({
            data() {
                return {
                    currentPrice: '0.00',
                    assetName: 'DECI Tech',
                    lastUpdate: '--:--:--',
                    connected: false,
                    previousPrice: 0
                }
            },
            computed: {
                priceColor() {
                    const curr = parseFloat(this.currentPrice);
                    const prev = parseFloat(this.previousPrice);
                    
                    if (curr > prev) return 'price-up';
                    if (curr < prev) return 'price-down';
                    return '';
                }
            },
            mounted() {
                const socket = io();

                socket.on('connect', () => { this.connected = true; });
                socket.on('disconnect', () => { this.connected = false; });

                socket.on('market_update', (data) => {
                    this.previousPrice = this.currentPrice;

                    this.currentPrice = data.price;
                    this.lastUpdate = data.timestamp;
                });
            }
        }).mount('#app');
    </script>
</body>
</html>

